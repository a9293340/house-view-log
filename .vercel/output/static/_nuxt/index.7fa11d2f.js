function kr(w,u){for(var U=0;U<u.length;U++){const g=u[U];if(typeof g!="string"&&!Array.isArray(g)){for(const d in g)if(d!=="default"&&!(d in w)){const C=Object.getOwnPropertyDescriptor(g,d);C&&Object.defineProperty(w,d,C.get?C:{enumerable:!0,get:()=>g[d]})}}}return Object.freeze(Object.defineProperty(w,Symbol.toStringTag,{value:"Module"}))}var xe={};(function(){var w=tinymce.util.Tools.resolve("tinymce.PluginManager"),u=function(){return u=Object.assign||function(t){for(var r,n=1,a=arguments.length;n<a;n++){r=arguments[n];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(t[i]=r[i])}return t},u.apply(this,arguments)},U=function(e){var t=typeof e;return e===null?"null":t==="object"&&(Array.prototype.isPrototypeOf(e)||e.constructor&&e.constructor.name==="Array")?"array":t==="object"&&(String.prototype.isPrototypeOf(e)||e.constructor&&e.constructor.name==="String")?"string":t},g=function(e){return function(t){return U(t)===e}},d=function(e){return function(t){return typeof t===e}},C=function(e){return function(t){return e===t}},l=g("string"),J=g("object"),Le=g("array"),Pe=C(null),X=d("boolean"),_e=function(e){return e==null},k=function(e){return!_e(e)},Ee=d("function"),ze=d("number"),Z=function(){},A=function(e){return function(){return e}},Be=function(e){return e},H=A(!1),$=A(!0),_=function(){return F},F=function(){var e=function(n){return n()},t=Be,r={fold:function(n,a){return n()},isSome:H,isNone:$,getOr:t,getOrThunk:e,getOrDie:function(n){throw new Error(n||"error: getOrDie called on none.")},getOrNull:A(null),getOrUndefined:A(void 0),or:t,orThunk:e,map:_,each:Z,bind:_,exists:H,forall:$,filter:function(){return _()},toArray:function(){return[]},toString:A("none()")};return r}(),R=function(e){var t=A(e),r=function(){return a},n=function(i){return i(e)},a={fold:function(i,o){return o(e)},isSome:$,isNone:H,getOr:t,getOrThunk:t,getOrDie:t,getOrNull:t,getOrUndefined:t,or:r,orThunk:r,map:function(i){return R(i(e))},each:function(i){i(e)},bind:n,exists:n,forall:n,filter:function(i){return i(e)?a:F},toArray:function(){return[e]},toString:function(){return"some("+e+")"}};return a},ke=function(e){return e==null?F:R(e)},c={some:R,none:_,from:ke},He=Object.keys,$e=Object.hasOwnProperty,Fe=function(e,t){for(var r=He(e),n=0,a=r.length;n<a;n++){var i=r[n],o=e[i];t(o,i)}},Re=function(e){return function(t,r){e[r]=t}},je=function(e,t,r,n){var a={};return Fe(e,function(i,o){(t(i,o)?r:n)(i,o)}),a},Me=function(e,t){var r={};return je(e,t,Re(r),Z),r},j=function(e,t){return $e.call(e,t)},Ve=function(e,t){return j(e,t)&&e[t]!==void 0&&e[t]!==null},Ge=Array.prototype.push,E=function(e){for(var t=[],r=0,n=e.length;r<n;++r){if(!Le(e[r]))throw new Error("Arr.flatten item "+r+" was not an array, input: "+e);Ge.apply(t,e[r])}return t},We=function(e,t){return t>=0&&t<e.length?c.some(e[t]):c.none()},Ke=function(e){return We(e,0)},qe=function(e,t){for(var r=0;r<e.length;r++){var n=t(e[r],r);if(n.isSome())return n}return c.none()};typeof window<"u"||Function("return this;")();var Je=function(e,t,r){if(l(r)||X(r)||ze(r))e.setAttribute(t,r+"");else throw console.error("Invalid call to Attribute.set. Key ",t,":: Value ",r,":: Element ",e),new Error("Attribute value was not simple")},Q=function(e,t,r){Je(e.dom,t,r)},Xe=function(e,t){e.dom.removeAttribute(t)},Ze=function(e,t){var r=t||document,n=r.createElement("div");if(n.innerHTML=e,!n.hasChildNodes()||n.childNodes.length>1)throw console.error("HTML does not have a single root node",e),new Error("HTML must have a single root node");return O(n.childNodes[0])},Qe=function(e,t){var r=t||document,n=r.createElement(e);return O(n)},Ye=function(e,t){var r=t||document,n=r.createTextNode(e);return O(n)},O=function(e){if(e==null)throw new Error("Node cannot be null or undefined");return{dom:e}},et=function(e,t,r){return c.from(e.dom.elementFromPoint(t,r)).map(O)},M={fromHtml:Ze,fromTag:Qe,fromText:Ye,fromDom:O,fromPoint:et},tt=tinymce.util.Tools.resolve("tinymce.dom.DOMUtils"),p=tinymce.util.Tools.resolve("tinymce.util.Promise"),rt=tinymce.util.Tools.resolve("tinymce.util.URI"),nt=tinymce.util.Tools.resolve("tinymce.util.XHR"),Y=function(e){return e.getParam("image_dimensions",!0,"boolean")},at=function(e){return e.getParam("image_advtab",!1,"boolean")},it=function(e){return e.getParam("image_uploadtab",!0,"boolean")},ot=function(e){return e.getParam("image_prepend_url","","string")},lt=function(e){return e.getParam("image_class_list")},ut=function(e){return e.getParam("image_description",!0,"boolean")},st=function(e){return e.getParam("image_title",!1,"boolean")},ct=function(e){return e.getParam("image_caption",!1,"boolean")},ft=function(e){return e.getParam("image_list",!1)},vt=function(e){return k(e.getParam("images_upload_url"))},mt=function(e){return k(e.getParam("images_upload_handler"))},gt=function(e){return e.getParam("a11y_advanced_options",!1,"boolean")},dt=function(e){return e.getParam("automatic_uploads",!0,"boolean")},ee=function(e,t){return Math.max(parseInt(e,10),parseInt(t,10))},ht=function(e){return new p(function(t){var r=document.createElement("img"),n=function(i){r.onload=r.onerror=null,r.parentNode&&r.parentNode.removeChild(r),t(i)};r.onload=function(){var i=ee(r.width,r.clientWidth),o=ee(r.height,r.clientHeight),s={width:i,height:o};n(p.resolve(s))},r.onerror=function(){n(p.reject("Failed to get image dimensions for: "+e))};var a=r.style;a.visibility="hidden",a.position="fixed",a.bottom=a.left="0px",a.width=a.height="auto",document.body.appendChild(r),r.src=e})},y=function(e){return e&&(e=e.replace(/px$/,"")),e},z=function(e){return e.length>0&&/^[0-9]+$/.test(e)&&(e+="px"),e},te=function(e){if(e.margin){var t=String(e.margin).split(" ");switch(t.length){case 1:e["margin-top"]=e["margin-top"]||t[0],e["margin-right"]=e["margin-right"]||t[0],e["margin-bottom"]=e["margin-bottom"]||t[0],e["margin-left"]=e["margin-left"]||t[0];break;case 2:e["margin-top"]=e["margin-top"]||t[0],e["margin-right"]=e["margin-right"]||t[1],e["margin-bottom"]=e["margin-bottom"]||t[0],e["margin-left"]=e["margin-left"]||t[1];break;case 3:e["margin-top"]=e["margin-top"]||t[0],e["margin-right"]=e["margin-right"]||t[1],e["margin-bottom"]=e["margin-bottom"]||t[2],e["margin-left"]=e["margin-left"]||t[1];break;case 4:e["margin-top"]=e["margin-top"]||t[0],e["margin-right"]=e["margin-right"]||t[1],e["margin-bottom"]=e["margin-bottom"]||t[2],e["margin-left"]=e["margin-left"]||t[3]}delete e.margin}return e},pt=function(e,t){var r=ft(e);l(r)?nt.send({url:r,success:function(n){t(JSON.parse(n))}}):Ee(r)?r(t):t(r)},bt=function(e,t,r){var n=function(){r.onload=r.onerror=null,e.selection&&(e.selection.select(r),e.nodeChanged())};r.onload=function(){!t.width&&!t.height&&Y(e)&&e.dom.setAttribs(r,{width:String(r.clientWidth),height:String(r.clientHeight)}),n()},r.onerror=n},yt=function(e){return new p(function(t,r){var n=new FileReader;n.onload=function(){t(n.result)},n.onerror=function(){r(n.error.message)},n.readAsDataURL(e)})},re=function(e){return e.nodeName==="IMG"&&(e.hasAttribute("data-mce-object")||e.hasAttribute("data-mce-placeholder"))},ne=function(e,t){return rt.isDomSafe(t,"img",e.settings)},f=tt.DOM,ae=function(e){return e.style.marginLeft&&e.style.marginRight&&e.style.marginLeft===e.style.marginRight?y(e.style.marginLeft):""},ie=function(e){return e.style.marginTop&&e.style.marginBottom&&e.style.marginTop===e.style.marginBottom?y(e.style.marginTop):""},oe=function(e){return e.style.borderWidth?y(e.style.borderWidth):""},I=function(e,t){return e.hasAttribute(t)?e.getAttribute(t):""},le=function(e,t){return e.style[t]?e.style[t]:""},ue=function(e){return e.parentNode!==null&&e.parentNode.nodeName==="FIGURE"},D=function(e,t,r){r===""?e.removeAttribute(t):e.setAttribute(t,r)},St=function(e){var t=f.create("figure",{class:"image"});f.insertAfter(t,e),t.appendChild(e),t.appendChild(f.create("figcaption",{contentEditable:"true"},"Caption")),t.contentEditable="false"},At=function(e){var t=e.parentNode;f.insertAfter(e,t),f.remove(t)},It=function(e){ue(e)?At(e):St(e)},se=function(e,t){var r=e.getAttribute("style"),n=t(r!==null?r:"");n.length>0?(e.setAttribute("style",n),e.setAttribute("data-mce-style",n)):e.removeAttribute("style")},ce=function(e,t){return function(r,n,a){r.style[n]?(r.style[n]=z(a),se(r,t)):D(r,n,a)}},fe=function(e,t){return e.style[t]?y(e.style[t]):I(e,t)},ve=function(e,t){var r=z(t);e.style.marginLeft=r,e.style.marginRight=r},me=function(e,t){var r=z(t);e.style.marginTop=r,e.style.marginBottom=r},ge=function(e,t){var r=z(t);e.style.borderWidth=r},de=function(e,t){e.style.borderStyle=t},Dt=function(e){return le(e,"borderStyle")},V=function(e){return e.nodeName==="FIGURE"},Tt=function(e){return e.nodeName==="IMG"},he=function(e){return f.getAttrib(e,"alt").length===0&&f.getAttrib(e,"role")==="presentation"},wt=function(e){return he(e)?"":I(e,"alt")},pe=function(){return{src:"",alt:"",title:"",width:"",height:"",class:"",style:"",caption:!1,hspace:"",vspace:"",border:"",borderStyle:"",isDecorative:!1}},Ut=function(e,t){var r=document.createElement("img");return D(r,"style",t.style),(ae(r)||t.hspace!=="")&&ve(r,t.hspace),(ie(r)||t.vspace!=="")&&me(r,t.vspace),(oe(r)||t.border!=="")&&ge(r,t.border),(Dt(r)||t.borderStyle!=="")&&de(r,t.borderStyle),e(r.getAttribute("style"))},Ct=function(e,t){var r=document.createElement("img");if(ye(e,u(u({},t),{caption:!1}),r),be(r,t.alt,t.isDecorative),t.caption){var n=f.create("figure",{class:"image"});return n.appendChild(r),n.appendChild(f.create("figcaption",{contentEditable:"true"},"Caption")),n.contentEditable="false",n}else return r},G=function(e,t){return{src:I(t,"src"),alt:wt(t),title:I(t,"title"),width:fe(t,"width"),height:fe(t,"height"),class:I(t,"class"),style:e(I(t,"style")),caption:ue(t),hspace:ae(t),vspace:ie(t),border:oe(t),borderStyle:le(t,"borderStyle"),isDecorative:he(t)}},v=function(e,t,r,n,a){r[n]!==t[n]&&a(e,n,r[n])},be=function(e,t,r){if(r){f.setAttrib(e,"role","presentation");var n=M.fromDom(e);Q(n,"alt","")}else{if(Pe(t)){var n=M.fromDom(e);Xe(n,"alt")}else{var n=M.fromDom(e);Q(n,"alt",t)}f.getAttrib(e,"role")==="presentation"&&f.setAttrib(e,"role","")}},Ot=function(e,t,r){(r.alt!==t.alt||r.isDecorative!==t.isDecorative)&&be(e,r.alt,r.isDecorative)},N=function(e,t){return function(r,n,a){e(r,a),se(r,t)}},ye=function(e,t,r){var n=G(e,r);v(r,n,t,"caption",function(a,i,o){return It(a)}),v(r,n,t,"src",D),v(r,n,t,"title",D),v(r,n,t,"width",ce("width",e)),v(r,n,t,"height",ce("height",e)),v(r,n,t,"class",D),v(r,n,t,"style",N(function(a,i){return D(a,"style",i)},e)),v(r,n,t,"hspace",N(ve,e)),v(r,n,t,"vspace",N(me,e)),v(r,n,t,"border",N(ge,e)),v(r,n,t,"borderStyle",N(de,e)),Ot(r,n,t)},x=function(e,t){var r=e.dom.styles.parse(t),n=te(r),a=e.dom.styles.parse(e.dom.styles.serialize(n));return e.dom.styles.serialize(a)},B=function(e){var t=e.selection.getNode(),r=e.dom.getParent(t,"figure.image");return r?e.dom.select("img",r)[0]:t&&(t.nodeName!=="IMG"||re(t))?null:t},Se=function(e,t){var r=e.dom,n=Me(e.schema.getTextBlockElements(),function(i,o){return!e.schema.isValidChild(o,"figure")}),a=r.getParent(t.parentNode,function(i){return Ve(n,i.nodeName)},e.getBody());return a?r.split(a,t):t},Nt=function(e){var t=B(e);return t?G(function(r){return x(e,r)},t):pe()},xt=function(e,t){var r=Ct(function(i){return x(e,i)},t);e.dom.setAttrib(r,"data-mce-id","__mcenew"),e.focus(),e.selection.setContent(r.outerHTML);var n=e.dom.select('*[data-mce-id="__mcenew"]')[0];if(e.dom.setAttrib(n,"data-mce-id",null),V(n)){var a=Se(e,n);e.selection.select(a)}else e.selection.select(n)},Lt=function(e,t){e.dom.setAttrib(t,"src",t.getAttribute("src"))},Pt=function(e,t){if(t){var r=e.dom.is(t.parentNode,"figure.image")?t.parentNode:t;e.dom.remove(r),e.focus(),e.nodeChanged(),e.dom.isEmpty(e.getBody())&&(e.setContent(""),e.selection.setCursorLocation())}},_t=function(e,t){var r=B(e);if(ye(function(a){return x(e,a)},t,r),Lt(e,r),V(r.parentNode)){var n=r.parentNode;Se(e,n),e.selection.select(r.parentNode)}else e.selection.select(r),bt(e,t,r)},Et=function(e,t){var r=t.src;return u(u({},t),{src:ne(e,r)?r:""})},zt=function(e,t){var r=B(e);if(r){var n=G(function(o){return x(e,o)},r),a=u(u({},n),t),i=Et(e,a);a.src?_t(e,i):Pt(e,r)}else t.src&&xt(e,u(u({},pe()),t))},Bt=function(e,t){var r=J(e)&&J(t);return r?L(e,t):t},kt=function(e){return function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];if(t.length===0)throw new Error("Can't merge zero objects");for(var n={},a=0;a<t.length;a++){var i=t[a];for(var o in i)j(i,o)&&(n[o]=e(n[o],i[o]))}return n}},L=kt(Bt),Ht=function(e){return e.length>0},$t=tinymce.util.Tools.resolve("tinymce.util.ImageUploader"),Ae=tinymce.util.Tools.resolve("tinymce.util.Tools"),Ie=function(e){return l(e.value)?e.value:""},Ft=function(e){return l(e.text)?e.text:l(e.title)?e.title:""},De=function(e,t){var r=[];return Ae.each(e,function(n){var a=Ft(n);if(n.menu!==void 0){var i=De(n.menu,t);r.push({text:a,items:i})}else{var o=t(n);r.push({text:a,value:o})}}),r},Te=function(e){return e===void 0&&(e=Ie),function(t){return t?c.from(t).map(function(r){return De(r,e)}):c.none()}},Rt=function(e){return Te(Ie)(e)},jt=function(e){return j(e,"items")},we=function(e,t){return qe(e,function(r){return jt(r)?we(r.items,t):r.value===t?c.some(r):c.none()})},Mt=function(e,t){return e.bind(function(r){return we(r,t)})},T={sanitizer:Te,sanitize:Rt,findEntry:Mt},Vt=function(e){return{title:"Advanced",name:"advanced",items:[{type:"input",label:"Style",name:"style"},{type:"grid",columns:2,items:[{type:"input",label:"Vertical space",name:"vspace",inputMode:"numeric"},{type:"input",label:"Horizontal space",name:"hspace",inputMode:"numeric"},{type:"input",label:"Border width",name:"border",inputMode:"numeric"},{type:"listbox",name:"borderstyle",label:"Border style",items:[{text:"Select...",value:""},{text:"Solid",value:"solid"},{text:"Dotted",value:"dotted"},{text:"Dashed",value:"dashed"},{text:"Double",value:"double"},{text:"Groove",value:"groove"},{text:"Ridge",value:"ridge"},{text:"Inset",value:"inset"},{text:"Outset",value:"outset"},{text:"None",value:"none"},{text:"Hidden",value:"hidden"}]}]}]}},Gt={makeTab:Vt},Wt=function(e){var t=T.sanitizer(function(h){return e.convertURL(h.value||h.url,"src")}),r=new p(function(h){pt(e,function(zr){h(t(zr).map(function(Br){return E([[{text:"None",value:""}],Br])}))})}),n=T.sanitize(lt(e)),a=at(e),i=it(e),o=vt(e),s=mt(e),b=Nt(e),S=ut(e),m=st(e),P=Y(e),Lr=ct(e),Pr=gt(e),_r=dt(e),Er=c.some(ot(e)).filter(function(h){return l(h)&&h.length>0});return r.then(function(h){return{image:b,imageList:h,classList:n,hasAdvTab:a,hasUploadTab:i,hasUploadUrl:o,hasUploadHandler:s,hasDescription:S,hasImageTitle:m,hasDimensions:P,hasImageCaption:Lr,prependURL:Er,hasAccessibilityOptions:Pr,automaticUploads:_r}})},Ue=function(e){var t={name:"src",type:"urlinput",filetype:"image",label:"Source"},r=e.imageList.map(function(m){return{name:"images",type:"listbox",label:"Image list",items:m}}),n={name:"alt",type:"input",label:"Alternative description",disabled:e.hasAccessibilityOptions&&e.image.isDecorative},a={name:"title",type:"input",label:"Image title"},i={name:"dimensions",type:"sizeinput"},o={type:"label",label:"Accessibility",items:[{name:"isDecorative",type:"checkbox",label:"Image is decorative"}]},s=e.classList.map(function(m){return{name:"classes",type:"listbox",label:"Class",items:m}}),b={type:"label",label:"Caption",items:[{type:"checkbox",name:"caption",label:"Show caption"}]},S=function(m){return m?{type:"grid",columns:2}:{type:"panel"}};return E([[t],r.toArray(),e.hasAccessibilityOptions&&e.hasDescription?[o]:[],e.hasDescription?[n]:[],e.hasImageTitle?[a]:[],e.hasDimensions?[i]:[],[u(u({},S(e.classList.isSome()&&e.hasImageCaption)),{items:E([s.toArray(),e.hasImageCaption?[b]:[]])})]])},Kt=function(e){return{title:"General",name:"general",items:Ue(e)}},Ce={makeTab:Kt,makeItems:Ue},qt=function(e){var t=[{type:"dropzone",name:"fileinput"}];return{title:"Upload",name:"upload",items:t}},Jt={makeTab:qt},Xt=function(e){return{prevImage:T.findEntry(e.imageList,e.image.src),prevAlt:e.image.alt,open:!0}},W=function(e){return{src:{value:e.src,meta:{}},images:e.src,alt:e.alt,title:e.title,dimensions:{width:e.width,height:e.height},classes:e.class,caption:e.caption,style:e.style,vspace:e.vspace,border:e.border,hspace:e.hspace,borderstyle:e.borderStyle,fileinput:[],isDecorative:e.isDecorative}},Oe=function(e,t){return{src:e.src.value,alt:e.alt.length===0&&t?null:e.alt,title:e.title,width:e.dimensions.width,height:e.dimensions.height,class:e.classes,style:e.style,caption:e.caption,hspace:e.hspace,vspace:e.vspace,border:e.border,borderStyle:e.borderstyle,isDecorative:e.isDecorative}},Zt=function(e,t){return/^(?:[a-zA-Z]+:)?\/\//.test(t)?c.none():e.prependURL.bind(function(r){return t.substring(0,r.length)!==r?c.some(r+t):c.none()})},Qt=function(e,t){var r=t.getData();Zt(e,r.src.value).each(function(n){t.setData({src:{value:n,meta:r.src.meta}})})},Yt=function(e,t,r){e.hasDescription&&l(r.alt)&&(t.alt=r.alt),e.hasAccessibilityOptions&&(t.isDecorative=r.isDecorative||t.isDecorative||!1),e.hasImageTitle&&l(r.title)&&(t.title=r.title),e.hasDimensions&&(l(r.width)&&(t.dimensions.width=r.width),l(r.height)&&(t.dimensions.height=r.height)),l(r.class)&&T.findEntry(e.classList,r.class).each(function(n){t.classes=n.value}),e.hasImageCaption&&X(r.caption)&&(t.caption=r.caption),e.hasAdvTab&&(l(r.style)&&(t.style=r.style),l(r.vspace)&&(t.vspace=r.vspace),l(r.border)&&(t.border=r.border),l(r.hspace)&&(t.hspace=r.hspace),l(r.borderstyle)&&(t.borderstyle=r.borderstyle))},er=function(e,t){var r=t.getData(),n=r.src.meta;if(n!==void 0){var a=L({},r);Yt(e,a,n),t.setData(a)}},tr=function(e,t,r,n){var a=n.getData(),i=a.src.value,o=a.src.meta||{};!o.width&&!o.height&&t.hasDimensions&&(Ht(i)?e.imageSize(i).then(function(s){r.open&&n.setData({dimensions:s})}).catch(function(s){return console.error(s)}):n.setData({dimensions:{width:"",height:""}}))},rr=function(e,t,r){var n=r.getData(),a=T.findEntry(e.imageList,n.src.value);t.prevImage=a,r.setData({images:a.map(function(i){return i.value}).getOr("")})},K=function(e,t,r,n){Qt(t,n),er(t,n),tr(e,t,r,n),rr(t,r,n)},nr=function(e,t,r,n){var a=n.getData(),i=T.findEntry(t.imageList,a.images);i.each(function(o){var s=a.alt===""||r.prevImage.map(function(b){return b.text===a.alt}).getOr(!1);s?o.value===""?n.setData({src:o,alt:r.prevAlt}):n.setData({src:o,alt:o.text}):n.setData({src:o})}),r.prevImage=i,K(e,t,r,n)},ar=function(e){var t=e["margin-top"]&&e["margin-bottom"]&&e["margin-top"]===e["margin-bottom"];return t?y(String(e["margin-top"])):""},ir=function(e){var t=e["margin-right"]&&e["margin-left"]&&e["margin-right"]===e["margin-left"];return t?y(String(e["margin-right"])):""},or=function(e){return e["border-width"]?y(String(e["border-width"])):""},lr=function(e){return e["border-style"]?String(e["border-style"]):""},ur=function(e,t,r){return t(e(t(r)))},sr=function(e,t,r){var n=te(e(r.style)),a=L({},r);return a.vspace=ar(n),a.hspace=ir(n),a.border=or(n),a.borderstyle=lr(n),a.style=ur(e,t,n),a},cr=function(e,t){var r=t.getData(),n=sr(e.parseStyle,e.serializeStyle,r);t.setData(n)},fr=function(e,t,r){var n=L(W(t.image),r.getData()),a=Ut(e.normalizeCss,Oe(n,!1));r.setData({style:a})},vr=function(e,t,r,n){var a=n.getData();n.block("Uploading image"),Ke(a.fileinput).fold(function(){n.unblock()},function(i){var o=URL.createObjectURL(i),s=function(){n.unblock(),URL.revokeObjectURL(o)},b=function(S){n.setData({src:{value:S,meta:{}}}),n.showTab("general"),K(e,t,r,n)};yt(i).then(function(S){var m=e.createBlobCache(i,o,S);t.automaticUploads?e.uploadImage(m).then(function(P){b(P.url),s()}).catch(function(P){s(),e.alertErr(P)}):(e.addToBlobCache(m),b(m.blobUri()),n.unblock())})})},mr=function(e,t,r){return function(n,a){a.name==="src"?K(e,t,r,n):a.name==="images"?nr(e,t,r,n):a.name==="alt"?r.prevAlt=n.getData().alt:a.name==="style"?cr(e,n):a.name==="vspace"||a.name==="hspace"||a.name==="border"||a.name==="borderstyle"?fr(e,t,n):a.name==="fileinput"?vr(e,t,r,n):a.name==="isDecorative"&&(n.getData().isDecorative?n.disable("alt"):n.enable("alt"))}},gr=function(e){return function(){e.open=!1}},dr=function(e){if(e.hasAdvTab||e.hasUploadUrl||e.hasUploadHandler){var t={type:"tabpanel",tabs:E([[Ce.makeTab(e)],e.hasAdvTab?[Gt.makeTab(e)]:[],e.hasUploadTab&&(e.hasUploadUrl||e.hasUploadHandler)?[Jt.makeTab(e)]:[]])};return t}else{var r={type:"panel",items:Ce.makeItems(e)};return r}},hr=function(e){return function(t){var r=Xt(t);return{title:"Insert/Edit Image",size:"normal",body:dr(t),buttons:[{type:"cancel",name:"cancel",text:"Cancel"},{type:"submit",name:"save",text:"Save",primary:!0}],initialData:W(t.image),onSubmit:e.onSubmit(t),onChange:mr(e,t,r),onClose:gr(r)}}},pr=function(e){return function(t){return function(r){var n=L(W(t.image),r.getData());e.execCommand("mceUpdateImage",!1,Oe(n,t.hasAccessibilityOptions)),e.editorUpload.uploadImagesAuto(),r.close()}}},br=function(e){return function(t){return ne(e,t)?ht(e.documentBaseURI.toAbsolute(t)).then(function(r){return{width:String(r.width),height:String(r.height)}}):p.resolve({width:"",height:""})}},yr=function(e){return function(t,r,n){return e.editorUpload.blobCache.create({blob:t,blobUri:r,name:t.name?t.name.replace(/\.[^\.]+$/,""):null,filename:t.name,base64:n.split(",")[1]})}},Sr=function(e){return function(t){e.editorUpload.blobCache.add(t)}},Ar=function(e){return function(t){e.windowManager.alert(t)}},Ir=function(e){return function(t){return x(e,t)}},Dr=function(e){return function(t){return e.dom.parseStyle(t)}},Tr=function(e){return function(t,r){return e.dom.serializeStyle(t,r)}},wr=function(e){return function(t){return $t(e).upload([t],!1).then(function(r){return r.length===0?p.reject("Failed to upload image"):r[0].status===!1?p.reject(r[0].error.message):r[0]})}},q=function(e){var t={onSubmit:pr(e),imageSize:br(e),addToBlobCache:Sr(e),createBlobCache:yr(e),alertErr:Ar(e),normalizeCss:Ir(e),parseStyle:Dr(e),serializeStyle:Tr(e),uploadImage:wr(e)},r=function(){Wt(e).then(hr(t)).then(e.windowManager.open)};return{open:r}},Ur=function(e){e.addCommand("mceImage",q(e).open),e.addCommand("mceUpdateImage",function(t,r){e.undoManager.transact(function(){return zt(e,r)})})},Cr=function(e){var t=e.attr("class");return t&&/\bimage\b/.test(t)},Ne=function(e){return function(t){for(var r=t.length,n=function(i){i.attr("contenteditable",e?"true":null)};r--;){var a=t[r];Cr(a)&&(a.attr("contenteditable",e?"false":null),Ae.each(a.getAll("figcaption"),n))}}},Or=function(e){e.on("PreInit",function(){e.parser.addNodeFilter("figure",Ne(!0)),e.serializer.addNodeFilter("figure",Ne(!1))})},Nr=function(e){e.ui.registry.addToggleButton("image",{icon:"image",tooltip:"Insert/edit image",onAction:q(e).open,onSetup:function(t){return t.setActive(k(B(e))),e.selection.selectorChangedWithUnbind("img:not([data-mce-object],[data-mce-placeholder]),figure.image",t.setActive).unbind}}),e.ui.registry.addMenuItem("image",{icon:"image",text:"Image...",onAction:q(e).open}),e.ui.registry.addContextMenu("image",{update:function(t){return V(t)||Tt(t)&&!re(t)?["image"]:[]}})};function xr(){w.add("image",function(e){Or(e),Nr(e),Ur(e)})}xr()})();const Hr=kr({__proto__:null,default:xe},[xe]);export{Hr as i};
