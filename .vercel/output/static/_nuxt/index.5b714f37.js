function jt(O,_){for(var w=0;w<_.length;w++){const m=_[w];if(typeof m!="string"&&!Array.isArray(m)){for(const s in m)if(s!=="default"&&!(s in O)){const C=Object.getOwnPropertyDescriptor(m,s);C&&Object.defineProperty(O,s,C.get?C:{enumerable:!0,get:()=>m[s]})}}}return Object.freeze(Object.defineProperty(O,Symbol.toStringTag,{value:"Module"}))}var z={};(function(){var O=tinymce.util.Tools.resolve("tinymce.PluginManager"),_=function(t){return function(n){return t===n}},w=_(null),m=function(){},s=function(t){return function(){return t}},C=function(t){return t},D=s(!1),k=s(!0),T=function(){return L},L=function(){var t=function(r){return r()},n=C,e={fold:function(r,a){return r()},isSome:D,isNone:k,getOr:n,getOrThunk:t,getOrDie:function(r){throw new Error(r||"error: getOrDie called on none.")},getOrNull:s(null),getOrUndefined:s(void 0),or:n,orThunk:t,map:T,each:m,bind:T,exists:D,forall:k,filter:function(){return T()},toArray:function(){return[]},toString:s("none()")};return e}(),S=function(t){var n=s(t),e=function(){return a},r=function(o){return o(t)},a={fold:function(o,i){return i(t)},isSome:k,isNone:D,getOr:n,getOrThunk:n,getOrDie:n,getOrNull:n,getOrUndefined:n,or:e,orThunk:e,map:function(o){return S(o(t))},each:function(o){o(t)},bind:r,exists:r,forall:r,filter:function(o){return o(t)?a:L},toArray:function(){return[t]},toString:function(){return"some("+t+")"}};return a},q=function(t){return t==null?L:S(t)},d={some:S,none:T,from:q},B=function(t,n){for(var e=0,r=t.length;e<r;e++){var a=t[e];if(n(a,e))return!0}return!1},G=function(t,n){for(var e=t.length,r=new Array(e),a=0;a<e;a++){var o=t[a];r[a]=n(o,a)}return r},W=function(t,n){for(var e=0,r=t.length;e<r;e++){var a=t[e];n(a,e)}},N=function(t){var n=t,e=function(){return n},r=function(a){n=a};return{get:e,set:r}},Y=function(t,n){var e=null,r=function(){w(e)||(clearTimeout(e),e=null)},a=function(){for(var o=[],i=0;i<arguments.length;i++)o[i]=arguments[i];r(),e=setTimeout(function(){e=null,t.apply(null,o)},n)};return{cancel:r,throttle:a}},H=function(t,n){t.insertContent(n)},A=function(){return A=Object.assign||function(n){for(var e,r=1,a=arguments.length;r<a;r++){e=arguments[r];for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(n[o]=e[o])}return n},A.apply(this,arguments)},I=Object.keys,J=Object.hasOwnProperty,M=function(t,n){for(var e=I(t),r=0,a=e.length;r<a;r++){var o=e[r],i=t[o];n(i,o)}},K=function(t,n){return Q(t,function(e,r){return{k:r,v:n(e,r)}})},Q=function(t,n){var e={};return M(t,function(r,a){var o=n(r,a);e[o.k]=o.v}),e},U=function(t,n){return J.call(t,n)},V=function(t,n){return n},X=function(t){return function(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];if(n.length===0)throw new Error("Can't merge zero objects");for(var r={},a=0;a<n.length;a++){var o=n[a];for(var i in o)U(o,i)&&(r[i]=t(r[i],o[i]))}return r}},Z=X(V),tt=function(t){var n=N(d.none()),e=function(){return n.get().each(t)},r=function(){e(),n.set(d.none())},a=function(){return n.get().isSome()},o=function(){return n.get()},i=function(h){e(),n.set(d.some(h))};return{clear:r,isSet:a,get:o,set:i}},$=function(){var t=tt(m),n=function(e){return t.get().each(e)};return A(A({},t),{on:n})},nt=function(t,n,e){return n===""||t.length>=n.length&&t.substr(e,e+n.length)===n},R=function(t,n){return t.indexOf(n)!==-1},et=function(t,n){return nt(t,n,0)},rt=tinymce.util.Tools.resolve("tinymce.Resource"),F=tinymce.util.Tools.resolve("tinymce.util.Delay"),at=tinymce.util.Tools.resolve("tinymce.util.Promise"),ot="tinymce.plugins.emoticons",it=function(t){return t.getParam("emoticons_database","emojis","string")},ut=function(t,n){var e=it(t);return t.getParam("emoticons_database_url",n+"/js/"+e+t.suffix+".js","string")},ct=function(t){return t.getParam("emoticons_database_id",ot,"string")},st=function(t){return t.getParam("emoticons_append",{},"object")},lt=function(t){return t.getParam("emoticons_images_url","https://twemoji.maxcdn.com/v/13.0.1/72x72/","string")},P="All",ft={symbols:"Symbols",people:"People",animals_and_nature:"Animals and Nature",food_and_drink:"Food and Drink",activity:"Activity",travel_and_places:"Travel and Places",objects:"Objects",flags:"Flags",user:"User Defined"},vt=function(t,n){return U(t,n)?t[n]:n},gt=function(t){var n=st(t);return K(n,function(e){return A({keywords:[],category:"user"},e)})},mt=function(t,n,e){var r=$(),a=$(),o=lt(t),i=function(u){return et(u.char,"<img")?u.char.replace(/src="([^"]+)"/,function(c,p){return'src="'+o+p+'"'}):u.char},h=function(u){var c={},p=[];M(u,function(b,Ct){var E={title:Ct,keywords:b.keywords,char:i(b),category:vt(ft,b.category)},At=c[E.category]!==void 0?c[E.category]:[];c[E.category]=At.concat([E]),p.push(E)}),r.set(c),a.set(p)};t.on("init",function(){rt.load(e,n).then(function(u){var c=gt(t);h(Z(u,c))},function(u){console.log("Failed to load emoticons: "+u),r.set({}),a.set([])})});var y=function(u){return u===P?l():r.get().bind(function(c){return d.from(c[u])}).getOr([])},l=function(){return a.get().getOr([])},g=function(){return[P].concat(I(r.get().getOr({})))},v=function(){return f()?globalThis.resolve(!0):new at(function(u,c){var p=15,b=F.setInterval(function(){f()?(F.clearInterval(b),u(!0)):(p--,p<0&&(console.log("Could not load emojis from url: "+n),F.clearInterval(b),c(!1)))},100)})},f=function(){return r.isSet()&&a.isSet()};return{listCategories:g,hasLoaded:f,waitForLoad:v,listAll:l,listCategory:y}},dt=function(t,n){return R(t.title.toLowerCase(),n)||B(t.keywords,function(e){return R(e.toLowerCase(),n)})},x=function(t,n,e){for(var r=[],a=n.toLowerCase(),o=e.fold(function(){return D},function(h){return function(y){return y>=h}}),i=0;i<t.length&&!((n.length===0||dt(t[i],a))&&(r.push({value:t[i].char,text:t[i].title,icon:t[i].char}),o(r.length)));i++);return r},j="pattern",ht=function(t,n){var e={pattern:"",results:x(n.listAll(),"",d.some(300))},r=N(P),a=function(g){var v=g.getData(),f=r.get(),u=n.listCategory(f),c=x(u,v[j],f===P?d.some(300):d.none());g.setData({results:c})},o=Y(function(g){a(g)},200),i={label:"Search",type:"input",name:j},h={type:"collection",name:"results"},y=function(){var g={type:"tabpanel",tabs:G(n.listCategories(),function(v){return{title:v,name:v,items:[i,h]}})};return{title:"Emoticons",size:"normal",body:g,initialData:e,onTabChange:function(v,f){r.set(f.newTabName),o.throttle(v)},onChange:o.throttle,onAction:function(v,f){f.name==="results"&&(H(t,f.value),v.close())},buttons:[{type:"cancel",text:"Close",primary:!0}]}},l=t.windowManager.open(y());l.focus(j),n.hasLoaded()||(l.block("Loading emoticons..."),n.waitForLoad().then(function(){l.redial(y()),o.throttle(l),l.focus(j),l.unblock()}).catch(function(g){l.redial({title:"Emoticons",body:{type:"panel",items:[{type:"alertbanner",level:"error",icon:"warning",text:"<p>Could not load emoticons</p>"}]},buttons:[{type:"cancel",text:"Close",primary:!0}],initialData:{pattern:"",results:[]}}),l.focus(j),l.unblock()}))},pt=function(t,n){t.addCommand("mceEmoticons",function(){return ht(t,n)})},yt=function(t){t.on("PreInit",function(){t.parser.addAttributeFilter("data-emoticon",function(n){W(n,function(e){e.attr("data-mce-resize","false"),e.attr("data-mce-placeholder","1")})})})},bt=function(t,n){t.ui.registry.addAutocompleter("emoticons",{ch:":",columns:"auto",minChars:2,fetch:function(e,r){return n.waitForLoad().then(function(){var a=n.listAll();return x(a,e,d.some(r))})},onAction:function(e,r,a){t.selection.setRng(r),t.insertContent(a),e.hide()}})},Ot=function(t){var n=function(){return t.execCommand("mceEmoticons")};t.ui.registry.addButton("emoticons",{tooltip:"Emoticons",icon:"emoji",onAction:n}),t.ui.registry.addMenuItem("emoticons",{text:"Emoticons...",icon:"emoji",onAction:n})};function wt(){O.add("emoticons",function(t,n){var e=ut(t,n),r=ct(t),a=mt(t,e,r);pt(t,a),Ot(t),bt(t,a),yt(t)})}wt()})();const Et=jt({__proto__:null,default:z},[z]);export{Et as i};
